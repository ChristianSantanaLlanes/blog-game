---
interface Post {
    title: string;
    description: string;
    date: Date;
    image?: string;
    slug: string;
    type: string;
    badge?: string;
}

interface Props {
    mainPost: Post;
    sidePosts: Post[];
}

const { mainPost, sidePosts } = Astro.props;
---

<section class="hero-grid">
    <article class="main-post">
        <div
            class="image-wrapper"
            transition:name={`image-/${mainPost.type}/${mainPost.slug}`}
        >
            {
                mainPost.image && (
                    <img
                        src={mainPost.image}
                        alt={mainPost.title}
                        loading="eager"
                    />
                )
            }
            <div class="overlay"></div>
            <div class="glow-border"></div>
        </div>
        <div class="content">
            <span class="badge animate-shimmer">{mainPost.badge}</span>
            <h2 transition:name={`title-/${mainPost.type}/${mainPost.slug}`}>
                <a href={`/${mainPost.type}/${mainPost.slug}`}
                    >{mainPost.title}</a
                >
            </h2>
            <p>{mainPost.description}</p>
        </div>
    </article>

    <div class="side-posts">
        {
            sidePosts.map((post, index) => (
                <article class="side-post" style={`--delay: ${index * 0.1}s`}>
                    <div
                        class="image-wrapper"
                        transition:name={`image-/${post.type}/${post.slug}`}
                    >
                        {post.image && (
                            <img
                                src={post.image}
                                alt={post.title}
                                loading="eager"
                            />
                        )}
                        <div class="overlay" />
                        <div class="glow-border" />
                    </div>
                    <div class="content">
                        <span class="badge">{post.badge}</span>
                        <h3
                            transition:name={`title-/${post.type}/${post.slug}`}
                        >
                            <a href={`/${post.type}/${post.slug}`}>
                                {post.title}
                            </a>
                        </h3>
                    </div>
                </article>
            ))
        }
    </div>
</section>

<style>
    .hero-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
        margin-bottom: 4rem;
        height: auto;
    }

    @media (min-width: 768px) {
        .hero-grid {
            grid-template-columns: 2fr 1fr;
            height: 520px;
        }
    }

    .image-wrapper {
        position: absolute;
        inset: 0;
        z-index: 1;
        overflow: hidden;
    }

    .image-wrapper img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(
            to top,
            rgba(5, 5, 8, 0.98) 0%,
            rgba(5, 5, 8, 0.7) 40%,
            rgba(5, 5, 8, 0.2) 100%
        );
        z-index: 2;
    }

    .glow-border {
        position: absolute;
        inset: 0;
        border-radius: 12px;
        z-index: 3;
        opacity: 0;
        transition: opacity var(--transition-normal);
        background: transparent;
        box-shadow:
            inset 0 0 30px rgba(0, 255, 157, 0.15),
            0 0 30px rgba(0, 255, 157, 0.1);
    }

    .main-post,
    .side-post {
        position: relative;
        border-radius: 12px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        padding: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: var(--color-bg-secondary);
        transition: all var(--transition-normal);
    }

    .main-post:hover,
    .side-post:hover {
        border-color: rgba(0, 255, 157, 0.3);
        transform: translateY(-3px);
    }

    .main-post:hover .glow-border,
    .side-post:hover .glow-border {
        opacity: 1;
    }

    .main-post:hover .image-wrapper img,
    .side-post:hover .image-wrapper img {
        transform: scale(1.08);
    }

    .main-post {
        height: 420px;
    }

    @media (min-width: 768px) {
        .main-post {
            height: 100%;
        }
    }

    .side-posts {
        display: grid;
        grid-template-rows: 1fr 1fr;
        gap: 1.5rem;
    }

    .side-post {
        padding: 1.5rem;
        animation: fadeInUp 0.6s ease forwards;
        animation-delay: var(--delay);
    }

    .content {
        position: relative;
        z-index: 10;
        pointer-events: none;
    }

    .content a {
        pointer-events: all;
    }

    .badge {
        display: inline-block;
        background: var(--gradient-primary);
        color: #000;
        padding: 6px 14px;
        font-weight: 700;
        text-transform: uppercase;
        font-size: 0.75rem;
        border-radius: 4px;
        margin-bottom: 1rem;
        letter-spacing: 0.5px;
        box-shadow: 0 0 15px var(--color-primary-glow);
    }

    .animate-shimmer {
        background: linear-gradient(
            90deg,
            var(--color-primary) 0%,
            var(--color-accent) 50%,
            var(--color-primary) 100%
        );
        background-size: 200% 100%;
        animation: shimmer 3s ease infinite;
    }

    h2 {
        font-size: 2.2rem;
        line-height: 1.15;
        margin-bottom: 1rem;
        text-shadow: 0 4px 8px rgba(0, 0, 0, 0.7);
    }

    h3 {
        font-size: 1.25rem;
        line-height: 1.25;
        margin-bottom: 0;
        text-shadow: 0 4px 8px rgba(0, 0, 0, 0.7);
    }

    h2 a,
    h3 a {
        color: #fff;
        text-decoration: none;
        transition: color var(--transition-fast);
    }

    h2 a:hover,
    h3 a:hover {
        color: var(--color-primary);
        text-shadow: 0 0 20px var(--color-primary-glow);
    }

    p {
        color: rgba(255, 255, 255, 0.75);
        font-size: 1.1rem;
        max-width: 90%;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        line-height: 1.5;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes shimmer {
        0% {
            background-position: -200% 0;
        }
        100% {
            background-position: 200% 0;
        }
    }
</style>
